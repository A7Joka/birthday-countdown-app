<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>العد التنازلي لعيد ميلادي</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Cairo', sans-serif; background: url('https://images.unsplash.com/photo-1519744792095-2f2205e87b6f') center/cover no-repeat; }
    .glass { backdrop-filter: blur(15px); background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.3); }
  </style>
</head>
<body class="min-h-screen flex flex-col justify-center items-center text-white">
  <div class="glass p-8 rounded-2xl shadow-lg w-11/12 max-w-lg text-center">
    <h1 class="text-3xl font-bold mb-4">العد التنازلي لعيد ميلادي 🎉</h1>
    <div id="countdown" class="grid grid-cols-3 gap-4 text-xl font-bold"></div>
    <p id="age" class="mt-4 text-lg"></p>
    <hr class="my-4 border-white/40">

    <h2 class="text-2xl mb-2">💌 اكتب رسالة</h2>
    <form id="messageForm" class="space-y-3">
      <input type="text" name="name" placeholder="الاسم (اختياري)" class="w-full p-2 rounded bg-white/20 border border-white/30 text-white placeholder-white">
      <textarea name="message" placeholder="اكتب تهنئة أو نصيحة..." class="w-full p-2 rounded bg-white/20 border border-white/30 text-white placeholder-white" required></textarea>
      <button type="submit" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 rounded font-bold">إرسال</button>
    </form>
    <p id="status" class="mt-2 text-sm"></p>
  </div>

<script>
const BIRTH_MONTH = 8; // أغسطس
const BIRTH_DAY = 29;
const BIRTH_YEAR = 2000; // غيّرها لسنة ميلادك
const API_URL = "https://script.google.com/macros/s/AKfycbw1OKgYFvM-UgurQT0uap2iNAKHlWFFgezhXK5c-03Wlk4GabK8UHQMcXjJaNW-3pEYig/exec"; // ضع رابط Google Apps Script هنا

function updateCountdown() {
  const now = new Date();
  let nextBirthday = new Date(now.getFullYear(), BIRTH_MONTH-1, BIRTH_DAY);
  if (now > nextBirthday) {
    nextBirthday.setFullYear(nextBirthday.getFullYear() + 1);
  }

  const diff = nextBirthday - now;
  const days = Math.floor(diff / (1000*60*60*24));
  const hours = Math.floor((diff / (1000*60*60)) % 24);
  const minutes = Math.floor((diff / (1000*60)) % 60);
  const seconds = Math.floor((diff / 1000) % 60);

  document.getElementById("countdown").innerHTML = `
    <div>🗓 ${days} يوم</div>
    <div>⏰ ${hours} ساعة</div>
    <div>⌛ ${minutes} دقيقة</div>
    <div>⏳ ${seconds} ثانية</div>
  `;

  const age = now.getFullYear() - BIRTH_YEAR - ((now.getMonth() > BIRTH_MONTH-1 || (now.getMonth() === BIRTH_MONTH-1 && now.getDate() >= BIRTH_DAY)) ? 0 : 1);
  document.getElementById("age").textContent = `عمري: ${age} سنة`;
}

setInterval(updateCountdown, 1000);
updateCountdown();

document.getElementById("messageForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const formData = new FormData(e.target);
  const data = Object.fromEntries(formData.entries());

  try {
    const res = await fetch(API_URL, {
      method: "POST",
      body: JSON.stringify(data),
      headers: { "Content-Type": "application/json" }
    });
    if (res.ok) {
      document.getElementById("status").textContent = "✅ تم إرسال الرسالة";
      e.target.reset();
    } else {
      document.getElementById("status").textContent = "❌ فشل الإرسال";
    }
  } catch {
    document.getElementById("status").textContent = "⚠️ حدث خطأ في الاتصال";
  }
});
</script>
</body>
</html>
